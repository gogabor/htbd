
@Cost = 2000

@EdictDuration = 3600
@EdictAfterEffect = 5000

country_edict = {
	name = "htbd_dragon_fear"
	length = @EdictDuration
	cost = { energy = @Cost }

	modifier = {
		pop_happiness = 0.05
		damage_vs_country_type_htbd_horde_mult = 0.1
	}
	
	potential = {
		has_country_flag = htbd_dragon_fear
		htbd_friend_civics = no
	}

	allow = {
		custom_tooltip = {
			fail_text = htbd_has_other_edict
			NOT = { has_edict = htbd_dragon_friend }
		}
	}

	effect = {
		remove_country_flag = htbd_dragon_scent
		remove_country_flag = htbd_dragon_trust
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.5
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_pacifist
			}
		}
		modifier = {
			factor = 2
			OR = {
				has_ethic = ethic_militarist
				has_ethic = ethic_fanatic_militarist
			}
		}
		modifier = {
			factor = 4
			OR = {
				has_ethic = ethic_fanatic_xenophobe
				has_ethic = ethic_xenophobe
			}
		}
		modifier = {
			factor = 5
			count_ships = {
				limit = {
					exists = owner
					owner = { is_country_type = htbd_horde }
					is_inside_border = prev
				}
				count > 2
			}
		}
	}
}

country_edict = {
	name = "htbd_dragon_friend"
	length = @EdictDuration
	cost = { energy = @Cost }

	modifier = {
		pop_happiness = 0.05
	}

	potential = {
		has_country_flag = htbd_dragon_friend
		htbd_foe_civics = no
	}

	allow = {
		custom_tooltip = {
			fail_text = htbd_has_other_edict
			NOT = { has_edict = htbd_dragon_fear }
		}
	}

	effect = {
		custom_tooltip = htbd_dragon_kin
		hidden_effect = {
			set_faction_hostility = {
				target = event_target:htbd_country
				set_hostile = no
				set_neutral = no
				set_friendly = yes
			}
			set_timed_country_flag = { flag = htbd_dragon_scent days = @EdictDuration }
			set_timed_country_flag = { flag = htbd_dragon_trust days = @EdictAfterEffect }
		}
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.5
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_militarist
			}
		}
		modifier = {
			factor = 2
			OR = {
				has_ethic = ethic_pacifist
				has_ethic = ethic_fanatic_pacifist
			}
		}
		modifier = {
			factor = 3
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
		}
		modifier = {
			factor = 5
			count_ships = {
				limit = {
					exists = owner
					owner = { is_country_type = htbd_horde }
					is_inside_border = prev
				}
				count > 2
			}
		}
	}
}
